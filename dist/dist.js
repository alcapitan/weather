"use strict";var g=Object.defineProperty;var r=(e,d)=>g(e,"name",{value:d,configurable:!0});atuiKernel_FooterLastedited(9,6,2023);function showSuggestedResults(e){const d=document.getElementById("suggestions");let i=d.querySelector("ul");for(i||(i=document.createElement("ul"),d.appendChild(i));i.firstChild;)i.removeChild(i.firstChild);if(e.length==0){const c=document.createElement("li");c.innerText="No matching city.",i.appendChild(c)}for(let c=0;c<e.length;c++){const o=document.createElement("li");o.innerText=e[c][0],o.onclick=()=>{sendRequest(e[c][1])},i.appendChild(o)}}r(showSuggestedResults,"showSuggestedResults");const searchButton=document.getElementById("atuiSearchservices_Submit");searchButton.addEventListener("click",createRequest),document.addEventListener("keyup",pressEnter);function pressEnter(e){e.code=="Enter"&&(e.preventDefault(),createRequest())}r(pressEnter,"pressEnter");const logText=document.getElementById("log");logText.innerHTML="Recherchez une ville en France m\xE9tropolitaine.";function log(e){document.getElementById("backgroundToday").style.background="hsl(var(--atuiKernel_Color-A30))",logText.innerHTML=e,logText.style.display="block",document.getElementById("today").style.display="none",document.getElementById("table").style.display="none"}r(log,"log");let inputCity=document.getElementById("atuiSearchservices_Input");inputCity.addEventListener("input",function(){updateSuggestions(inputCity.value)});function createRequest(){if(!navigator.onLine){log("Non connect\xE9 \xE0 Internet.");return}sendRequest(inputCity.value)}r(createRequest,"createRequest");const requestHeader=new Headers({Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer 8d432d87acf6b2a4e36ee21cd41d5821cb1db3133b673e79dd0f6f0b80cca53f"}),token="8d432d87acf6b2a4e36ee21cd41d5821cb1db3133b673e79dd0f6f0b80cca53f";async function updateSuggestions(e){document.getElementById("backgroundToday").style.background="hsl(var(--atuiKernel_Color-A30))",log("Recherche de villes (0/2)");let d;try{d=await fetch(`https://api.meteo-concept.com/api/location/cities?token=${token}&search=${e}`,{method:"GET",headers:requestHeader,mode:"cors"})}catch{log("Le service de l'API est indisponible.")}const i=await d.json();log("Traitement (1/2)");let c=i.cities.length;c>5&&(c=5);let o=[],l;for(let t=0;t<c;t++){try{l=[i.cities[t].name+" ("+i.cities[t].cp+")",i.cities[t].cp]}catch{l=""}o.push(l)}showSuggestedResults(o),log("S\xE9lectionnez une ville.")}r(updateSuggestions,"updateSuggestions");async function sendRequest(e){document.getElementById("backgroundToday").style.background="hsl(var(--atuiKernel_Color-A30))",log("Recherche des villes (0/3)");let d;try{d=await fetch(`https://api.meteo-concept.com/api/location/cities?token=${token}&search=${e}`,{method:"GET",headers:requestHeader,mode:"cors"})}catch{log("Le service de l'API est indisponible.")}const i=await d.json();if(i.cities.length==0){log("Aucune ville trouv\xE9e.");return}log("R\xE9ception des donn\xE9es m\xE9t\xE9o (1/3)");const c=i.cities[0].insee;try{d=await fetch(`https://api.meteo-concept.com/api/forecast/daily?token=${token}&insee=${c}`,{method:"GET",headers:requestHeader,mode:"cors"})}catch{log("Le service de l'API est indisponible.")}let o=await d.json();log("Traitement (2/3)"),e=o.city.name+" ("+o.city.cp+")";let l=[];for(let t=0;t<8;t++)l[t]={},o.forecast[t].datetime=new Date(o.forecast[t].datetime),l[t].date=[convertDay(o.forecast[t].datetime.getDay()),o.forecast[t].datetime.getDate(),convertMonth(o.forecast[t].datetime.getMonth())],l[t].kmwind=o.forecast[t].wind10m,l[t].kmgust=o.forecast[t].gust10m,l[t].dirwind=o.forecast[t].dirwind10m+180,l[t].weather=o.forecast[t].weather,l[t].temp=(o.forecast[t].tmin+o.forecast[t].tmax)/2,l[t].tempmin=o.forecast[t].tmin,l[t].tempmax=o.forecast[t].tmax,l[t].probarain=o.forecast[t].probarain,l[t].rr10=o.forecast[t].rr10;console.info(l),updateWebpage(l,e)}r(sendRequest,"sendRequest");function convertDay(e){return{0:"Dimanche",1:"Lundi",2:"Mardi",3:"Mercredi",4:"Jeudi",5:"Vendredi",6:"Samedi"}[e]}r(convertDay,"convertDay");function convertMonth(e){return{0:"Janvier",1:"F\xE9vrier",2:"Mars",3:"Avril",4:"Mai",5:"Juin",6:"Juillet",7:"Ao\xFBt",8:"Septembre",9:"Octobre",10:"Novembre",11:"D\xE9cembre"}[e]}r(convertMonth,"convertMonth");function convertInfos(e){return{0:["sun","ensoleill\xE9"],1:["cloud-sun","\xE9claircies"],2:["cloud-sun","\xE9claircies"],3:["clouds","nuageux"],4:["clouds","nuageux"],5:["clouds","nuageux"],6:["cloud-haze","brouillard"],7:["cloud-haze","brouillard"],10:["cloud-drizzle","pluie fine"],11:["cloud-rain","pluie"],12:["cloud-rain-heavy","temp\xEAte pluvieuse"],13:["cloud-drizzle","pluie fine"],14:["cloud-rain","pluie"],15:["cloud-rain-heavy","temp\xEAte pluvieuse"],16:["cloud-haze","brouillard"],20:["cloud-snow","neige l\xE9g\xE8re"],21:["cloud-snow","neige"],22:["cloud-snow","temp\xEAte de neige"],30:["cloud-drizzle","pluie fine"],31:["cloud-rain","pluie"],32:["cloud-rain-heavy","temp\xEAte pluvieuse"],40:["cloud-drizzle","pluie fine"],41:["cloud-rain","pluie"],42:["cloud-rain-heavy","temp\xEAte pluvieuse"],43:["cloud-drizzle","pluie fine"],44:["cloud-rain","pluie"],45:["cloud-rain-heavy","temp\xEAte pluvieuse"],46:["cloud-drizzle","pluie fine"],47:["cloud-rain","pluie"],48:["cloud-rain-heavy","temp\xEAte pluvieuse"],60:["cloud-snow","neige l\xE9g\xE8re"],61:["cloud-snow","neige"],62:["cloud-snow","temp\xEAte de neige"],63:["cloud-snow","neige l\xE9g\xE8re"],64:["cloud-snow","neige"],65:["cloud-snow","temp\xEAte de neige"],66:["cloud-snow","neige l\xE9g\xE8re"],67:["cloud-snow","neige"],68:["cloud-snow","temp\xEAte de neige"],70:["cloud-drizzle","pluie fine"],71:["cloud-rain","pluie"],72:["cloud-rain-heavy","temp\xEAte pluvieuse"],73:["cloud-drizzle","pluie fine"],74:["cloud-rain","pluie"],75:["cloud-rain-heavy","temp\xEAte pluvieuse"],76:["cloud-drizzle","pluie fine"],77:["cloud-rain","pluie"],78:["cloud-rain-heavy","temp\xEAte pluvieuse"],100:["cloud-lighting","orages"],101:["cloud-lighting","orages"],102:["cloud-lighting","orages"],103:["cloud-lighting","orages"],104:["cloud-lighting","orages"],105:["cloud-lighting","orages"],106:["cloud-lighting","orages"],107:["cloud-lighting","orages"],108:["cloud-lighting","orages"],120:["cloud-lighting","orages"],121:["cloud-lighting","orages"],122:["cloud-lighting","orages"],123:["cloud-lighting","orages"],124:["cloud-lighting","orages"],125:["cloud-lighting","orages"],126:["cloud-lighting","orages"],127:["cloud-lighting","orages"],128:["cloud-lighting","orages"],130:["cloud-lighting","orages"],131:["cloud-lighting","orages"],132:["cloud-lighting","orages"],133:["cloud-lighting","orages"],134:["cloud-lighting","orages"],135:["cloud-lighting","orages"],136:["cloud-lighting","orages"],137:["cloud-lighting","orages"],138:["cloud-lighting","orages"],140:["cloud-lighting","orages"],141:["cloud-lighting","orages"],142:["cloud-lighting","orages"],210:["cloud-drizzle","pluie fine"],211:["cloud-rain","pluie"],212:["cloud-rain-heavy","temp\xEAte pluvieuse"],220:["cloud-snow","neige l\xE9g\xE8re"],221:["cloud-snow","neige"],222:["cloud-snow","temp\xEAte de neige"],230:["cloud-drizzle","pluie fine"],231:["cloud-rain","pluie"],232:["cloud-rain-heavy","temp\xEAte pluvieuse"],235:["cloud-hail","gr\xEAle"]}[e]}r(convertInfos,"convertInfos");function updateWebpage(e,d){logText.style.display="none",document.getElementById("today").style.display="flex",document.getElementById("cityToday").textContent=d;let i=document.getElementById("tempTodayMin");i.textContent=e[0].tempmin+" \xB0C";let c=document.getElementById("tempTodayMax");c.textContent=e[0].tempmax+" \xB0C",e[0].temp<=5?document.getElementById("backgroundToday").style.background="var(--veryCold)":e[0].temp<=15?document.getElementById("backgroundToday").style.background="var(--cold)":e[0].temp<=25?document.getElementById("backgroundToday").style.background="var(--lukewarm)":e[0].temp<=35?document.getElementById("backgroundToday").style.background="var(--hot)":e[0].temp>=36&&(document.getElementById("backgroundToday").style.background="var(--veryHot)");let o=document.getElementById("skyTodayImg");o.classList.forEach(n=>{n.startsWith("bi-")&&o.classList.replace(n,`bi-${convertInfos(e[0].weather)[0]}`)}),e[0].probarain>50?(document.getElementById("skyTodayProbarain").style.display="block",document.getElementById("skyTodayProbarain").textContent=e[0].probarain+" %",document.getElementById("skyTodayAccumurain").style.display="block",document.getElementById("skyTodayAccumurain").textContent=e[0].rr10+" mm"):(document.getElementById("skyTodayProbarain").style.display="none",document.getElementById("skyTodayAccumurain").style.display="none");let l=document.getElementById("windTodayImg");l.style.transform="rotate("+e[0].dirwind+"deg)";let t=document.getElementById("windTodayMin");t.textContent=e[0].kmwind+" km/h";const u=document.getElementById("windTodayMax");u.textContent=e[0].kmgust+" km/h",document.getElementById("table").style.display="block";const a=document.getElementsByClassName("nextDay");for(let n=0;n<a.length;n++)a[n].childNodes[1].innerHTML="<p>"+e[n+1].date[0]+" "+e[n+1].date[1]+" "+e[n+1].date[2]+"</p>",a[n].childNodes[3].childNodes[1].classList.forEach(s=>{s.startsWith("bi-")&&a[n].childNodes[3].childNodes[1].classList.replace(s,`bi-${convertInfos(e[n+1].weather)[0]}`)}),e[n+1].probarain>50?(a[n].childNodes[3].childNodes[3].childNodes[1].style.display="block",a[n].childNodes[3].childNodes[3].childNodes[1].textContent=e[n+1].probarain+" %",a[n].childNodes[3].childNodes[3].childNodes[3].style.display="block",a[n].childNodes[3].childNodes[3].childNodes[3].textContent=e[n+1].rr10+" mm"):(a[n].childNodes[3].childNodes[3].childNodes[1].style.display="none",a[n].childNodes[3].childNodes[3].childNodes[3].style.display="none"),a[n].childNodes[5].childNodes[1].textContent=e[n+1].tempmin+" \xB0C",a[n].childNodes[5].childNodes[3].textContent=e[n+1].tempmax+" \xB0C",a[n].childNodes[7].childNodes[1].style.transform="rotate("+e[n+1].dirwind+"deg)",a[n].childNodes[7].childNodes[3].childNodes[1].textContent=e[n+1].kmwind+" km/h",a[n].childNodes[7].childNodes[3].childNodes[3].textContent=e[n+1].kmgust+" km/h"}r(updateWebpage,"updateWebpage");
//# sourceMappingURL=dist.js.map
